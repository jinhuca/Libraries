<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:d="http://schemas.microsoft.com/expression/blend/2008">
  <ResourceDictionary.MergedDictionaries>
    <ResourceDictionary Source="Shared.xaml"/>
  </ResourceDictionary.MergedDictionaries>

  <ControlTemplate x:Key="ComboBoxItemTemplate" TargetType="{x:Type ComboBoxItem}">
    <ControlTemplate.Resources>
      <Storyboard x:Key="Hovering">
        <ColorAnimation Storyboard.TargetName="backgroundRectangleBackgroundBrush"
                        Storyboard.TargetProperty="Color"
                        To="{StaticResource Color_Background_MouseOver}"
                        Duration="0"/>
        <ColorAnimation Storyboard.TargetName="backgroundRectangleStrokeBrush"
                        Storyboard.TargetProperty="Color"
                        To="{StaticResource Color_Border_MouseOver}"
                        Duration="0"/>
      </Storyboard>

      <Storyboard x:Key="HoveringOff">
        <ColorAnimation Storyboard.TargetName="backgroundRectangleBackgroundBrush"
                        Storyboard.TargetProperty="Color"
                        To="{StaticResource Color_Background_Normal}"
                        Duration="0"/>
        <ColorAnimation Storyboard.TargetName="backgroundRectangleStrokeBrush"
                        Storyboard.TargetProperty="Color"
                        To="{StaticResource Color_Border_Normal}"
                        Duration="0"/>
      </Storyboard>
      
      <Storyboard x:Key="Selecting">
        <ColorAnimation Storyboard.TargetName="backgroundRectangleBackgroundBrush"
                        Storyboard.TargetProperty="Color"
                        To="{StaticResource Color_Background_Checked}"
                        Duration="0"/>
        <ColorAnimation Storyboard.TargetName="backgroundRectangleStrokeBrush"
                        Storyboard.TargetProperty="Color"
                        To="{StaticResource Color_Border_Checked}"
                        Duration="0"/>
      </Storyboard>

      <Storyboard x:Key="SelectingOff">
        <ColorAnimation Storyboard.TargetName="backgroundRectangleBackgroundBrush"
                        Storyboard.TargetProperty="Color"
                        To="{StaticResource Color_Background_Normal}"
                        Duration="0"/>
        <ColorAnimation Storyboard.TargetName="backgroundRectangleStrokeBrush"
                        Storyboard.TargetProperty="Color"
                        To="{StaticResource Color_Border_Normal}"
                        Duration="0"/>
      </Storyboard>

    </ControlTemplate.Resources>

    <Grid SnapsToDevicePixels="true">
      <Rectangle x:Name="backgroundRectangle" 
                       IsHitTestVisible="False" 
                       Opacity="1" RadiusX="1" RadiusY="1" 
                       >
        <Rectangle.Fill>
          <SolidColorBrush x:Name="backgroundRectangleBackgroundBrush"
                           Color="{StaticResource Color_Background_Normal}"/>
        </Rectangle.Fill>
        <Rectangle.Stroke>
          <SolidColorBrush x:Name="backgroundRectangleStrokeBrush"
                           Color="{StaticResource Color_Border_Normal}"/>
        </Rectangle.Stroke>
      </Rectangle>
      
      <Rectangle x:Name="selectedRectangle" 
                       IsHitTestVisible="False" 
                       Opacity="0" RadiusX="1" RadiusY="1" 
                       Fill="{StaticResource Brush_Background_Selected}"/>
      <ContentPresenter x:Name="contentPresenter" 
                              Margin="5,2,0,2" 
                              VerticalAlignment="Center"/>
      <Rectangle x:Name="focusVisualElement" 
                       Visibility="Collapsed" 
                       RadiusX="1" RadiusY="1" 
                       Stroke="{StaticResource Brush_Border_Focused}" 
                       StrokeThickness="1"/>
    </Grid>

    <ControlTemplate.Triggers>

      <Trigger Property="IsHighlighted" Value="true">
        <Trigger.ExitActions>
          <BeginStoryboard Storyboard="{StaticResource SelectingOff}"/>
        </Trigger.ExitActions>
        <Trigger.EnterActions>
          <BeginStoryboard Storyboard="{StaticResource Selecting}"/>
        </Trigger.EnterActions>
      </Trigger>

      <Trigger Property="IsMouseOver" Value="True">
        <Trigger.EnterActions>
          <BeginStoryboard Storyboard="{StaticResource Hovering}"/>
        </Trigger.EnterActions>
        <Trigger.ExitActions>
          <BeginStoryboard Storyboard="{StaticResource HoveringOff}"/>
        </Trigger.ExitActions>
      </Trigger>

      <Trigger Property="IsSelected" Value="True">
        <Trigger.EnterActions>
          <BeginStoryboard Storyboard="{StaticResource Selecting}"/>
        </Trigger.EnterActions>
        <Trigger.ExitActions>
          <BeginStoryboard Storyboard="{StaticResource SelectingOff}"/>
        </Trigger.ExitActions>
      </Trigger>

      <!--<Trigger Property="IsEnabled" Value="false">
              <Setter Property="Foreground" Value="{DynamicResource DisabledForegroundBrush}"/>
            </Trigger>-->
    </ControlTemplate.Triggers>

  </ControlTemplate>

  <Style TargetType="{x:Type ComboBoxItem}">
    <Setter Property="Foreground" Value="{StaticResource Brush_Foreground_Normal}"/>
    <Setter Property="SnapsToDevicePixels" Value="true"/>
    <Setter Property="Template" Value="{StaticResource ComboBoxItemTemplate}"/>
  </Style>
  
</ResourceDictionary>