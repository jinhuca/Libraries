<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

  <ResourceDictionary.MergedDictionaries>
    <ResourceDictionary Source="Shared.xaml"/>
  </ResourceDictionary.MergedDictionaries>

  <!-- ControlTemplate for TrackBar -->
  <ControlTemplate x:Key="ThumbTrackBarTemplate" TargetType="Thumb">
    <ControlTemplate.Resources>
      <Storyboard x:Key="Hovering">
        <ColorAnimation Storyboard.TargetName="BrushThumbBackground"
                        Storyboard.TargetProperty="Color"
                        To="{StaticResource Color_Background_MouseOver_TrackBar}"
                        Duration="0"/>
      </Storyboard>
      <Storyboard x:Key="Pressing">
        <ColorAnimation Storyboard.TargetName="BrushThumbBackground"
                        Storyboard.TargetProperty="Color"
                        To="{StaticResource Color_Background_Pressed_TrackBar}" 
                        Duration="0"/>
      </Storyboard>
      <Storyboard x:Key="Disabling">
        <ColorAnimation Storyboard.TargetName="BrushThumbBackground"
                        Storyboard.TargetProperty="Color"
                        To="{StaticResource Color_Background_Disable}"
                        Duration="0"/>
      </Storyboard>
    </ControlTemplate.Resources>
    <Grid Margin="0,0,0,0" x:Name="Grid">
      <VisualStateManager.VisualStateGroups>
        <VisualStateGroup Name="CommonStates">
          <VisualState x:Name="Normal"/>
          <VisualState x:Name="MouseOver" Storyboard="{StaticResource Hovering}"/>
          <VisualState x:Name="Pressed" Storyboard="{StaticResource Pressing}"/>
          <VisualState x:Name="Disabled" Storyboard="{StaticResource Disabling}"/>
        </VisualStateGroup>
        <VisualStateGroup Name="FocusStates">
          <VisualState x:Name="Focused"/>
          <VisualState x:Name="Unfocused"/>
        </VisualStateGroup>
        <VisualStateGroup Name="ValidationStates">
          <VisualState x:Name="Valid"/>
          <VisualState x:Name="InvalidFocused"/>
          <VisualState x:Name="InvalidUnfocused"/>
        </VisualStateGroup>
      </VisualStateManager.VisualStateGroups>
      <Rectangle HorizontalAlignment="Stretch" VerticalAlignment="Stretch" 
                 Width="Auto" Height="Auto" RadiusX="12" RadiusY="12" 
                 Margin="2" Opacity="1" MinHeight="10">
        <Rectangle.Fill>
          <SolidColorBrush x:Name="BrushThumbBackground" 
                           Color="{StaticResource Color_Background_Normal_TrackBar}"/>
        </Rectangle.Fill>
      </Rectangle>
    </Grid>
  </ControlTemplate>

  <!-- ControlTemplate for LineUp and LineDown RepeatButton -->
  <ControlTemplate x:Key="RepeatButtonLineTemplate" TargetType="RepeatButton">
    <ControlTemplate.Resources>
      <Storyboard x:Key="Hovering">
        <ColorAnimation Storyboard.TargetName="fillArrow"
                        Storyboard.TargetProperty="Color"
                        To="{StaticResource Color_Background_MouseOver_TrackBar}"
                        Duration="0"/>
      </Storyboard>
      <Storyboard x:Key="Pressing">
        <ColorAnimation Storyboard.TargetName="fillArrow"
                            Storyboard.TargetProperty="Color"
                            To="{StaticResource Color_Background_Pressed_TrackBar}"
                            Duration="0"/>
      </Storyboard>
      <Storyboard x:Key="Unfocusing">
        <ColorAnimation Storyboard.TargetName="fillArrow"
                            Storyboard.TargetProperty="Color"
                            To="{StaticResource Color_Background_Normal_TrackBar}"
                            Duration="0"/>
      </Storyboard>
    </ControlTemplate.Resources>
    <Grid Background="{x:Null}" Focusable="False">
      <VisualStateManager.VisualStateGroups>
        <VisualStateGroup x:Name="CommonStates">
          <VisualState x:Name="Normal"/>
          <VisualState x:Name="MouseOver" Storyboard="{StaticResource Hovering}"/>
          <VisualState x:Name="Pressed" Storyboard="{StaticResource Pressing}"/>
          <VisualState x:Name="Disabled"/>
        </VisualStateGroup>
        <VisualStateGroup x:Name="FocusStates">
          <VisualState x:Name="Focused"/>
          <VisualState x:Name="Unfocused" Storyboard="{StaticResource Unfocusing}"/>
        </VisualStateGroup>
      </VisualStateManager.VisualStateGroups>
      <Polygon x:Name="Arrow" Points="16,0,0,32,32,32" StrokeThickness="0">
        <Polygon.Fill>
          <SolidColorBrush x:Name="fillArrow" Color="{StaticResource Color_Background_Normal_TrackBar}"/>
        </Polygon.Fill>
      </Polygon>
    </Grid>
  </ControlTemplate>
  
  <!-- Style for PageUp and PageDown RepeatButton -->
  <Style x:Key="RepeatButtonPageStyle" TargetType="RepeatButton">
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="RepeatButton">
          <Rectangle Fill="{TemplateBinding Background}" 
                     Stroke="{TemplateBinding BorderBrush}" 
                     StrokeThickness="{TemplateBinding BorderThickness}"/>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
    <Setter Property="Background" Value="Transparent"/>
    <Setter Property="BorderBrush" Value="Transparent" />
    <Setter Property="IsTabStop" Value="false" />
    <Setter Property="Focusable" Value="false" />
  </Style>
  
  <!-- ControlTemplate for ScrollBar -->
  <ControlTemplate x:Key="ScrollBarTemplate" TargetType="{x:Type ScrollBar}">
    <Grid x:Name="GridRoot" 
          Width="{DynamicResource {x:Static SystemParameters.VerticalScrollBarWidthKey}}" 
          Background="{StaticResource Brush_Background_Normal}">
      <Grid.RowDefinitions>
        <RowDefinition MaxHeight="32" />
        <RowDefinition Height="0.712*"/>
        <RowDefinition MaxHeight="32"/>
      </Grid.RowDefinitions>

      <RepeatButton x:Name="RepeatButtonLineUp" Command="ScrollBar.LineUpCommand" 
                    Template="{StaticResource RepeatButtonLineTemplate}"/>

      <Track x:Name="PART_Track" Grid.Row="1" Orientation="Vertical" IsDirectionReversed="true">
        <Track.Thumb>
          <Thumb Template="{StaticResource ThumbTrackBarTemplate}"/>
        </Track.Thumb>
        <Track.IncreaseRepeatButton>
          <RepeatButton x:Name="PageUp" Style="{StaticResource RepeatButtonPageStyle}" 
                        Command="ScrollBar.PageDownCommand"/>
        </Track.IncreaseRepeatButton>
        <Track.DecreaseRepeatButton>
          <RepeatButton x:Name="PageDown" 
                        Style="{StaticResource RepeatButtonPageStyle}" 
                        Command="ScrollBar.PageUpCommand"/>
        </Track.DecreaseRepeatButton>
      </Track>

      <RepeatButton x:Name="RepeatButtonLineDown" Command="ScrollBar.LineDownCommand" Grid.Row="2" 
                    Template="{StaticResource RepeatButtonLineTemplate}">
        <RepeatButton.LayoutTransform>
          <RotateTransform Angle="180"/>
        </RepeatButton.LayoutTransform>
      </RepeatButton>

    </Grid>

    <ControlTemplate.Triggers>
      <Trigger Property="Orientation" Value="Horizontal">
        <Setter Property="LayoutTransform" TargetName="GridRoot">
          <Setter.Value>
            <RotateTransform Angle="-90" />
          </Setter.Value>
        </Setter>
        <Setter TargetName="PART_Track" Property="Orientation" Value="Vertical" />
        <Setter Property="Command" Value="ScrollBar.LineLeftCommand" TargetName="RepeatButtonLineUp" />
        <Setter Property="Command" Value="ScrollBar.LineRightCommand" TargetName="RepeatButtonLineDown" />
        <Setter Property="Command" Value="ScrollBar.PageLeftCommand" TargetName="PageDown" />
        <Setter Property="Command" Value="ScrollBar.PageRightCommand" TargetName="PageUp" />
      </Trigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>

  <!-- Style for ScrollBar -->
  <Style TargetType="{x:Type ScrollBar}">
    <Setter Property="Template" Value="{StaticResource ScrollBarTemplate}"/>
    <Setter Property="Stylus.IsFlicksEnabled" Value="false"/>
  </Style>

</ResourceDictionary>